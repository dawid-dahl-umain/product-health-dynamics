flowchart TB
    subgraph config ["CONFIGURATION (set once)"]
        ER["<b>Engineering Rigor</b><br/><i>How careful is this Human or AI?</i><br/>0 = careless, 1 = meticulous"]
    end

    subgraph derived ["DERIVED FROM RIGOR"]
        BI["<b>Average Impact</b><br/><i>Help or hurt on average?</i>"]
        BS["<b>Consistency</b><br/><i>Predictable or erratic?</i>"]
        MH["<b>Ceiling</b><br/><i>Best achievable result</i>"]
    end

    subgraph loop ["DEVELOPMENT LOOP (repeats for each code change)"]
        direction TB
        
        PH["<b>Current Product Health</b><br/><i>How easy is the code to change right now?</i><br/>1 = nightmare, 10 = dream"]
        
        SS["<b>System Tractability</b><br/><i>Healthy: absorbs mistakes, amplifies improvements</i><br/><i>Unhealthy: amplifies mistakes, resists improvements</i>"]
        
        CE["<b>Change Event</b><br/><i>One code change happens</i><br/>Outcome = rigor traits + system state + randomness"]
        
        NPH["<b>New Product Health</b><br/><i>System evolved: better, worse, or same</i>"]

        PH --> SS
        SS --> CE
        CE --> NPH
        NPH -->|"becomes current state<br/>for next change"| PH
    end

    ER --> BI & BS & MH
    BI & BS & MH --> CE

    %% Styling
    style config fill:#1b5e20,stroke:#81c784,color:#fff
    style derived fill:#e65100,stroke:#ffb74d,color:#fff
    style loop fill:#0d47a1,stroke:#64b5f6,color:#fff

    classDef nodeStyle fill:#fff,stroke:#333,color:#000,stroke-width:2px
    class ER,PH,BI,BS,MH,SS,CE,NPH nodeStyle

    linkStyle default stroke:#00ced1,stroke-width:2px
